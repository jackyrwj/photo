# 在线证件照换底色工具 🎨

一个基于 Flask 和 OpenCV 的在线证件照背景色更换工具，支持智能抠图和自动换底色。上传证件照后，自动生成白底、蓝底、红底三种常用底色，也支持自定义任意颜色。

## ✨ 功能特点

- 🚀 **智能自动处理**：上传图片后自动生成白、蓝、红三种常用底色
- 🎯 **拖拽上传**：支持拖拽文件或点击上传，操作便捷
- 🎨 **自定义颜色**：除预设颜色外，支持自定义任意底色
- 📱 **响应式设计**：适配桌面端和移动端
- ⚡ **实时预览**：上传即可看到处理效果
- 💾 **独立下载**：每种颜色都可单独下载

## 🖼️ 效果展示

<div align="center">
  <img src="./static/demo/image.jpg" width="200" alt="原图">
  <img src="./static/demo/red.jpg" width="200" alt="红底">
  <img src="./static/demo/white.jpg" width="200" alt="白底">
</div>

<p align="center">
  <em>左：原图 | 中：红底 | 右：白底</em>
</p>

## 🚀 快速开始

### 环境要求

- Python 3.7+
- pip

### 安装依赖

```bash
pip install flask opencv-python numpy
```

### 运行应用

```bash
python app.py
```

然后在浏览器中访问：`http://127.0.0.1:5000`

## 📖 使用方法

### Web 应用（推荐）

1. 启动服务器：`python app.py`
2. 打开浏览器访问 `http://127.0.0.1:5000`
3. 拖拽或点击上传证件照
4. 自动生成白底、蓝底、红底三种效果
5. 点击下载按钮保存图片
6. 如需其他颜色，选择颜色后点击"处理自定义颜色"

### 命令行工具

```bash
python main.py -i your_image.jpg -p output_folder
```

参数说明：
- `-i, --image`：输入图片路径
- `-p, --path`：输出文件夹路径

## 🛠️ 技术栈

- **后端**：Flask - 轻量级 Web 框架
- **图像处理**：OpenCV - 智能抠图和背景替换
- **前端**：原生 HTML/CSS/JavaScript
- **算法**：K-means 聚类算法进行背景分割

## 📁 项目结构

```
IDPhotos/
├── app.py                 # Flask Web 应用主程序
├── main.py               # 命令行工具
├── templates/
│   └── index.html        # 前端页面
├── static/
│   ├── style.css         # 样式文件
│   ├── script.js         # JavaScript 交互逻辑
│   └── demo/             # 示例图片
├── uploads/              # 上传文件临时存储（自动创建）
├── outputs/              # 处理后的文件（自动创建）
└── README.md
```

## 🎯 核心功能说明

### 智能抠图算法

使用 K-means 聚类算法自动识别背景色：
1. 将图片像素进行聚类分析
2. 识别背景区域
3. 生成精确的前景蒙版
4. 应用高斯模糊优化边缘
5. 融合新背景色

### 预设颜色

- **白色** `#ffffff` - 最常用的证件照底色
- **蓝色** `#2196F3` - 标准蓝底
- **红色** `#ff0000` - 标准红底
- 深红、灰色、浅蓝、深蓝、暗红等多种可选

## ⚠️ 注意事项

- 请使用背景整洁的正装证件照，效果最佳
- 建议上传高清图片以获得更好的处理效果
- 支持的图片格式：JPG、JPEG、PNG
- 单个文件大小限制：16MB

## 📝 更新日志

### v2.0.0 (2025-11-25)
- ✨ 新增 Web 应用界面
- ✨ 支持自动生成三种常用底色
- ✨ 添加拖拽上传功能
- ✨ 优化页面布局和用户体验
- 🐛 修复 numpy 兼容性问题

### v1.0.0
- 🎉 初始版本，支持命令行换底色

## 📄 License

MIT License

## 👨‍💻 作者

jackyrwj

## 🙏 致谢

- 原始命令行版本参考自微信公众号：搬运代码吧
- 使用 OpenCV 进行图像处理
- 使用 Flask 构建 Web 应用
